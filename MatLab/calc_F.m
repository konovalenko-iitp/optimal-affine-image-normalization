
function [F_0, F_1, F_2] = calc_F(p)

    c1 = 2*p(1,1)*p(3,2)^2 - 2*p(1,2)*p(3,1)*p(3,2);
    c2 = 2*p(1,2)*p(3,1)^2 - 2*p(1,1)*p(3,1)*p(3,2);
    c3 = 2*p(1,1)*p(3,2)*p(3,3) - 2*p(1,3)*p(3,1)*p(3,2) + 2*p(1,1)*p(3,2)*p(3,3) - 2*p(1,2)*p(3,1)*p(3,3);
    c4 = p(1,1)*p(3,1)^2;
    c5 = 2*p(1,3)*p(3,1)^2 - 2*p(1,1)*p(3,1)*p(3,3);
    c6 = 2*p(1,1)*p(3,3)^2 - 2*p(1,3)*p(3,1)*p(3,3);
    
    c7 = 2*p(2,1)*p(3,2)^2 - 2*p(2,2)*p(3,1)*p(3,2);
    c8 = 2*p(2,2)*p(3,1)^2 - 2*p(2,1)*p(3,1)*p(3,2);
    c9 = 2*p(2,1)*p(3,2)*p(3,3) - 2*p(2,3)*p(3,1)*p(3,2) + 2*p(2,1)*p(3,2)*p(3,3) - 2*p(2,2)*p(3,1)*p(3,3);
    c10 = p(2,1)*p(3,1)^2;
    c11 = 2*p(2,3)*p(3,1)^2 - 2*p(2,1)*p(3,1)*p(3,3);
    c12 = 2*p(2,1)*p(3,3)^2 - 2*p(2,3)*p(3,1)*p(3,3);

    c13 = 2*p(1,2)*p(3,1)^2 - 2*p(1,1)*p(3,1)*p(3,2);
    c14 = 2*p(1,1)*p(3,2)^2 - 2*p(1,2)*p(3,1)*p(3,2);
    c15 = 2*p(1,2)*p(3,1)*p(3,3) - 2*p(1,3)*p(3,2)*p(3,1) + 2*p(1,2)*p(3,1)*p(3,3) - 2*p(1,1)*p(3,2)*p(3,3);
    c16 = p(1,2)*p(3,2)^2;
    c17 = 2*p(1,3)*p(3,2)^2 - 2*p(1,2)*p(3,2)*p(3,3);
    c18 = 2*p(1,2)*p(3,3)^2 - 2*p(1,3)*p(3,2)*p(3,3);

    c19 = 2*p(2,2)*p(3,1)^2 - 2*p(2,1)*p(3,1)*p(3,2);
    c20 = 2*p(2,1)*p(3,2)^2 - 2*p(2,2)*p(3,1)*p(3,2);
    c21 = 2*p(2,2)*p(3,1)*p(3,3) - 2*p(2,3)*p(3,2)*p(3,1) + 2*p(2,2)*p(3,1)*p(3,3) - 2*p(2,1)*p(3,2)*p(3,3);
    c22 = p(2,2)*p(3,2)^2;
    c23 = 2*p(2,3)*p(3,2)^2 - 2*p(2,2)*p(3,2)*p(3,3);
    c24 = 2*p(2,2)*p(3,3)^2 - 2*p(2,3)*p(3,2)*p(3,3);

    c25 = p(1,2)*p(3,1) - p(1,1)*p(3,2);
    c26 = p(1,3)*p(3,1) - p(1,1)*p(3,3);
    c27 = p(1,1)*p(3,1);
    c28 = p(2,2)*p(3,1) - p(2,1)*p(3,2);
    c29 = p(2,3)*p(3,1) - p(2,1)*p(3,3);
    c30 = p(2,1)*p(3,1);

    c31 = p(1,1)^2*p(3,1);
    c32 = p(1,2)^2*p(3,1)^2 + p(1,1)^2*p(3,2)^2 - 2*p(1,1)*p(1,2)*p(3,1)*p(3,2);
    c33 = 2*p(1,2)*p(1,3)*p(3,1)^2 + 2*p(1,1)^2*p(3,2)*p(3,3) - 2*p(1,1)*p(1,2)*p(3,1)*p(3,3) - 2*p(1,1)*p(1,3)*p(3,1)*p(3,2);
    c34 = p(1,3)^2*p(3,1)^2 + p(1,1)^2*p(3,3)^2 - 2*p(1,1)*p(1,3)*p(3,1)*p(3,3);
    c35 = 2*p(1,1)*p(1,2)*p(3,1) - 2*p(1,1)^2*p(3,2);
    c36 = 2*p(1,1)*p(1,3)*p(3,1) - 2*p(1,1)^2*p(3,3);

    c37 = p(2,1)^2*p(3,1);
    c38 = p(2,2)^2*p(3,1)^2 + p(2,1)^2*p(3,2)^2 - 2*p(2,1)*p(2,2)*p(3,1)*p(3,2);
    c39 = 2*p(2,2)*p(2,3)*p(3,1)^2 + 2*p(2,1)^2*p(3,2)*p(3,3) - 2*p(2,1)*p(2,2)*p(3,1)*p(3,3) - 2*p(2,1)*p(2,3)*p(3,1)*p(3,2);
    c40 = p(2,3)^2*p(3,1)^2 + p(2,1)^2*p(3,3)^2 - 2*p(2,1)*p(2,3)*p(3,1)*p(3,3);
    c41 = 2*p(2,1)*p(2,2)*p(3,1) - 2*p(2,1)^2*p(3,2);
    c42 = 2*p(2,1)*p(2,3)*p(3,1) - 2*p(2,1)^2*p(3,3);

    c43 = p(1,2)*p(2,2)*p(3,1)^2 - p(1,2)*p(2,1)*p(3,1)*p(3,2) - p(1,1)*p(2,2)*p(3,1)*p(3,2) + p(1,1)*p(2,1)*p(3,2)^2;
    c44 = p(1,2)*p(2,3)*p(3,1)^2 - p(1,2)*p(2,1)*p(3,1)*p(3,3) + p(1,3)*p(2,2)*p(3,1)^2 - p(1,3)*p(2,1)*p(3,1)*p(3,2) + ...
        - p(1,1)*p(2,3)*p(3,1)*p(3,2) + p(1,1)*p(2,1)*p(3,2)*p(3,3) -p(1,1)*p(2,2)*p(3,1)*p(3,3) + p(1,1)*p(2,1)*p(3,2)*p(3,3);
    c45 = p(1,3)*p(2,3)*p(3,1)^2 - p(1,3)*p(2,1)*p(3,1)*p(3,3) - p(1,1)*p(2,3)*p(3,1)*p(3,3) + p(1,1)*p(2,1)*p(3,3)^2;

    c46 = p(1,1)*p(2,2)*p(3,1) - 2*p(1,1)*p(2,1)*p(3,2) + p(1,2)*p(2,1)*p(3,1);
    c47 = p(1,1)*p(2,3)*p(3,1) - 2*p(1,1)*p(2,1)*p(3,3) + p(1,3)*p(2,1)*p(3,1);
    c48 = p(1,1)*p(2,1)*p(3,1);
    
    Z = @(x, y) p(3,1)*x+p(3,2)*y+p(3,3);
    z1 = @(x) p(3,1)*x+p(3,3);
    z2 = @(y) p(3,2)*y+p(3,3);
    
    n = 6;

    %%
    
    F_0 = @(x,y) x*(x^2 + y^2)*y / 3;

    %%
    
    F_1 = cell(1, n);
    for i = 1 : n
        F_1{i} = @(x,y) 0;
    end

    F_1{1} = @(x,y) 1/(2*p(3,1)^3)*((1/(18*p(3,2)^3))*c1*(6*(p(3,2)^3*y^3 + z1(x)^3)*log(Z(x,y)) + ...
    + p(3,2)*y*(-2*p(3,2)^2*y^2 + 3*p(3,2)*y*z1(x) - 6*z1(x)^2)) + y^2*x*c2/2 + (c3/(4*p(3,2)^2))*(p(3,2)*y*(2*z1(x) + ...
     - p(3,2)*y) - 2*(z1(x)^2 - p(3,2)^2*y^2)*log(Z(x,y))) + y*x^2*c4 + y*x*c5 + c6*(p(3,2)*y + z1(x))*log(Z(x,y))/p(3,2) - c6*y);
 
    F_1{2} = @(x,y) 1/(2*p(3,1)^3)*((1/(18*p(3,2).^3))*c7*(6*(p(3,2).^3*y.^3 + z1(x).^3)*log(Z(x,y)) + ...
    + p(3,2)*y*(-2*p(3,2).^2*y.^2 + 3*p(3,2)*y*z1(x) - 6*z1(x).^2)) + y.^2*x*c8/2 + (c9/(4*p(3,2).^2))*(p(3,2)*y*(2*z1(x) + ...
     - p(3,2)*y) - 2*(z1(x).^2 - p(3,2).^2*y.^2)*log(Z(x,y))) + y*x.^2*c10 + y*x*c11 + c12*(p(3,2)*y + z1(x))*log(Z(x,y))/p(3,2) - c12*y);
 
    F_1{3} = @(x,y) x^2*y / 2;

    F_1{4} = @(x,y) 1/(2*p(3,2)^3)*((1/(18*p(3,1)^3))*c13*(6*(p(3,1).^3*x.^3 + z2(y).^3)*log(Z(x,y)) + ...
     + p(3,1)*x*(-2*p(3,1).^2*x.^2 + 3*p(3,1)*x*z2(y) - 6*z2(y).^2)) + x.^2*y*c14/2 + (c15/(4*p(3,1).^2))*(p(3,1)*x*(2*z2(y) + ...
    - p(3,1)*x) - 2*(z2(y).^2 - p(3,1).^2*x.^2)*log(Z(x,y))) + x*y.^2*c16 + y*x*c17 + c18*(p(3,1)*x + z2(y))*log(Z(x,y))/p(3,1) - c18*x);

    F_1{5} = @(x,y) 1/(2*p(3,2).^3)*((1/(18*p(3,1).^3))*c19*(6*(p(3,1).^3*x.^3 + z2(y).^3)*log(Z(x,y)) + ...
     + p(3,1)*x*(-2*p(3,1).^2*x.^2 + 3*p(3,1)*x*z2(y) - 6*z2(y).^2)) + x.^2*y*c20/2 + (c21/(4*p(3,1).^2))*(p(3,1)*x*(2*z2(y) + ...
    - p(3,1)*x) - 2*(z2(y).^2 - p(3,1).^2*x.^2)*log(Z(x,y))) + x*y.^2*c22 + y*x*c23 + c24*(p(3,1)*x + z2(y))*log(Z(x,y))/p(3,1) - c24*x);
    
    F_1{6} = @(x,y) y^2*x / 2;

    %%
    
    F_2 = cell(n, n);
    for i = 1 : n
        for j = 1 : n
            F_2{i, j} = @(x,y) 0;
        end
    end

    F_2{1, 1} = @(x,y) 1/(p(3,1)^3)*(c31*x*y - c32/(2*p(3,2)^3)*(2*z1(x)^2*log(Z(x,y)) + ...
    + y*p(3,2)*(y*p(3,2) - 2*z1(x))) - c33/p(3,2)^2*(p(3,2)*y - z1(x)*log(Z(x,y))) + ...
    - c34/p(3,2)*log(Z(x,y)) + c35/(4*p(3,2)^2)*(p(3,2)*y*(2*z1(x) - p(3,2)*y) +...
    - 2*(z1(x)^2 - p(3,2)^2*y^2)*log(Z(x,y))) + c36/p(3,2)*Z(x,y)*log(Z(x,y)) - c36*y);

    F_2{1, 2} = @(x,y) 1/(p(3,1)^3)*(- c43/(2*p(3,2)^3)*(2*z1(x)^2*log(Z(x,y)) + ...
     + y*p(3,2)*(y*p(3,2) - 2*z1(x))) - c44/p(3,2)^2*(p(3,2)*y - z1(x)*log(Z(x,y))) + ...
     - c45/p(3,2)*log(Z(x,y))+ c46/(4*p(3,2)^2)*(p(3,2)*y*(2*z1(x) - p(3,2)*y) +...
     - 2*(z1(x)^2 - p(3,2)^2*y^2)*log(Z(x,y))) + c47/p(3,2)*Z(x,y)*log(Z(x,y)) - c47*y + x*y*c48);

    F_2{1, 3} = @(x,y) 1/(p(3,1)^2)*(c25/(4*p(3,2)^2)*(p(3,2)*y*(2*z1(x) - p(3,2)*y) - 2*(z1(x)^2 - p(3,2)^2*y^2)*log(Z(x,y))) + ...
        + c26 / p(3,2)*Z(x,y)*log(Z(x,y)) - c26*y + c27*x*y);

    F_2{2, 1} = F_2{1, 2};

    F_2{2, 2} = @(x,y) 1/(p(3,1)^3)*(c37*x*y - c38/(2*p(3,2)^3)*(2*z1(x)^2*log(Z(x,y)) + ...
    + y*p(3,2)*(y*p(3,2) - 2*z1(x))) - c39/p(3,2)^2*(p(3,2)*y - z1(x)*log(Z(x,y))) + ...
    - c40/p(3,2)*log(Z(x,y)) + c41/(4*p(3,2)^2)*(p(3,2)*y*(2*z1(x) - p(3,2)*y) +...
    - 2*(z1(x)^2 - p(3,2)^2*y^2)*log(Z(x,y))) + c42/p(3,2)*Z(x,y)*log(Z(x,y)) - c42*y);

    F_2{2, 3} = @(x,y) 1/(p(3,1)^2)*(c28/(4*p(3,2)^2)*(p(3,2)*y*(2*z1(x) - p(3,2)*y) - 2*(z1(x)^2 - p(3,2)^2*y^2)*log(Z(x,y))) + ...
        + c29 / p(3,2)*Z(x,y)*log(Z(x,y)) - c29*y + c30*x*y);

    F_2{3, 1} = F_2{1, 3};

    F_2{3, 2} = F_2{2, 3};

    F_2{3, 3} = @(x,y) x*y;

    F_2{4, 4} = F_2{1, 1};

    F_2{4, 5} = F_2{1, 2};

    F_2{4, 6} = F_2{1, 3};

    F_2{5, 4} = F_2{2, 1};

    F_2{5, 5} = F_2{2, 2};

    F_2{5, 6} = F_2{2, 3};

    F_2{6, 4} = F_2{3, 1};

    F_2{6, 5} = F_2{3, 2};

    F_2{6, 6} = F_2{3, 3};
end

